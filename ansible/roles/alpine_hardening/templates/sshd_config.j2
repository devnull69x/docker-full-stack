# {{ ansible_managed }} - FÜHRERBUNKER SECURE CONFIG

# ===== GLOBAL PARANOIA =====
Port {{ ssh_port | default(2222) }}
ListenAddress 0.0.0.0
Protocol 2
HostKey /etc/ssh/ssh_host_ed25519_key
HostKey /etc/ssh/ssh_host_rsa_key
DebianBanner no

# ===== ACCESS CONTROL =====
PermitRootLogin no
AllowUsers {{ admin_user }}
DenyUsers *
AllowGroups ssh-access
LoginGraceTime 30s

# ===== CRYPTO (STURMABTEILUNG APPROVED) =====
KexAlgorithms curve25519-sha256@libssh.org
Ciphers chacha20-poly1305@openssh.com,aes256-gcm@openssh.com
MACs hmac-sha2-512-etm@openssh.com
HostKeyAlgorithms ssh-ed25519,ssh-ed25519-cert-v01@openssh.com

# ===== MONITORING =====
MaxAuthTries 2
MaxSessions 3
ClientAliveInterval 300
ClientAliveCountMax 0
PrintLastLog no
PrintMotd yes
Banner /etc/ssh/banner

# ===== FÜHRERBUNKER SPECIAL DIRECTIVES =====
UsePAM yes
UseDNS no
AllowAgentForwarding no
AllowTcpForwarding no
X11Forwarding no
PermitEmptyPasswords no
PasswordAuthentication no
AuthenticationMethods publickey